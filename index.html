<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Portofolio — Minecraft Full Power (Smooth Cinematic)</title>

<!-- Font & Leaflet -->
<link href="https://db.onlinewebfonts.com/c/9a402d6a80ceda873798bf79af582916?family=Minecrafter" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
<script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

<style>
/* ================= THEME CORE ================= */
:root{
  --bg: linear-gradient(to bottom, #0e0e0f 0%, #1b1b20 40%, #222 100%);
  --card:#151518; --card-2:#1b1b20; --text:#e9efe8; --muted:#a6afb0;
  --accent:#6bd26b; --accent-2:#39b439; --accent-grad:linear-gradient(45deg,var(--accent),var(--accent-2));
  --grid:#2a2a2f; --shadow:0 10px 24px rgba(0,0,0,.45); --radius:20px; --pixel:6px;
  --spot-x:50%; --spot-y:30%; --spot-size:180px; --dim:rgba(0,0,0,.78);
  --blur: 10px;
  --ease: cubic-bezier(.2,.8,.2,1);
  --ease-soft: cubic-bezier(.25,.1,.25,1);
  --ease-cine: cubic-bezier(.16,1,.3,1);
  --trans-fast: .25s var(--ease);
  --trans: .45s var(--ease);
  --trans-slow: .7s var(--ease-cine);
}
:root[data-theme="day"]{
  --bg: linear-gradient(to bottom, #87ceeb 0%, #b7e17b 50%, #95d07c 100%);
  --card:#f7fff0; --card-2:#e9f6dd; --text:#172312; --muted:#3b5b2d; --grid:#b3d894; --dim:rgba(0,0,0,.55)
}
/* ================= BIOMES ================= */
body.biome-forest{ --bg: linear-gradient(#5aa66b, #2f6f3c 40%, #1f3e25 90%)}
body.biome-desert{ --bg: linear-gradient(#f0d28a, #e8b95e 40%, #b87e40 90%)}
body.biome-snow{ --bg: linear-gradient(#dfefff, #b7d0ef 40%, #7ea2c7 90%)}
body.biome-mesa{ --bg: linear-gradient(#d67b4a, #a64f2f 45%, #5b2b1a 90%)}
body.biome-swamp{ --bg: linear-gradient(#6b8f62, #415d44 45%, #243628 90%)}

/* Base */
*{box-sizing:border-box}
html,body{height:100%}
html{scroll-behavior:smooth}
body{
  margin:0;color:var(--text);font-family:"Minecrafter",system-ui,sans-serif;
  background:var(--bg);image-rendering:pixelated;overflow-x:hidden;
  transition:background var(--trans-slow);
}

/* Motion preferences */
@media (prefers-reduced-motion: reduce){
  *{animation:none !important; transition:none !important}
}

/* Pixel grid */
.grid{position:fixed;inset:0;pointer-events:none;opacity:.12;z-index:-2;
  background-image:linear-gradient(var(--grid) 1px,transparent 1px),linear-gradient(90deg,var(--grid) 1px,transparent 1px);
  background-size:24px 24px}

/* Parallax */
.parallax{position:fixed;inset:0;z-index:-1;pointer-events:none;overflow:hidden}
.layer{position:absolute;inset:0;opacity:.16;mix-blend-mode:soft-light;will-change:transform;transition:transform .2s var(--ease-soft)}
.layer.l1{background-image:radial-gradient(#39b43922 1px,#0000 1px);background-size:40px 40px}
.layer.l2{background-image:radial-gradient(#6bd26b22 1px,#0000 1px);background-size:60px 60px}
.layer.l3{background-image:radial-gradient(#ffffff11 1px,#0000 1px);background-size:80px 80px}

/* NAV */
header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(120%) blur(8px);
  background:rgba(0,0,0,.35);border-bottom:1px solid #2a2a30;transition:background var(--trans), border-color var(--trans)}
:root[data-theme="day"] header{background:rgba(255,255,255,.45);border-bottom-color:#cfe6b7}
.nav{max-width:1100px;margin:0 auto;display:flex;gap:16px;align-items:center;justify-content:space-between;padding:12px 18px}
.brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text)}
.logo{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;
  box-shadow:inset 0 -3px 0 rgba(0,0,0,.25),var(--shadow);background:var(--accent-grad);transition:transform var(--trans-fast)}
.brand:hover .logo{transform:translateY(-2px)}
.brand-title{font-size:18px;letter-spacing:1px}
.links{display:flex;gap:14px;align-items:center}
.link{color:var(--text);text-decoration:none;font-weight:700;position:relative;padding:6px 8px;border-radius:10px;transition:opacity var(--trans-fast)}
.link::after{content:"";position:absolute;left:10px;right:10px;bottom:3px;height:2px;background:var(--accent-grad);transform:scaleX(0);transform-origin:left;transition:transform .25s}
.link:hover::after{transform:scaleX(1)}
.btn{appearance:none;border:0;border-radius:14px;padding:10px 14px;font-weight:800;letter-spacing:.3px;cursor:pointer;transition:transform var(--trans-fast), box-shadow var(--trans-fast), filter var(--trans-fast)}
.btn-ghost{background:transparent;color:var(--text);border:1px dashed #2b2b33}
.btn-primary{background:var(--accent-grad);color:#0a200a;box-shadow:inset 0 -3px 0 rgba(0,0,0,.25),var(--shadow)}
.pix-hover{box-shadow:0 0 0 var(--pixel) rgba(0,0,0,0)}
.pix-hover:hover{transform:translate(-2px,-2px);box-shadow:calc(var(--pixel)/2) calc(var(--pixel)/2) 0 0 #0006}

/* Hamburger */
.menu-toggle{display:none;appearance:none;background:var(--card-2);color:var(--text);border:1px solid #2b2b33;border-radius:12px;padding:10px 12px;font-weight:800;box-shadow:var(--shadow)}
.menu-toggle .bars{display:inline-grid;gap:4px}
.menu-toggle .bars i{display:block;width:22px;height:2px;background:currentColor;border-radius:2px;transition:transform .2s,opacity .2s}
.menu-toggle[aria-expanded="true"] .bars i:nth-child(1){transform:translateY(6px) rotate(45deg)}
.menu-toggle[aria-expanded="true"] .bars i:nth-child(2){opacity:0}
.menu-toggle[aria-expanded="true"] .bars i:nth-child(3){transform:translateY(-6px) rotate(-45deg)}
.mobile-panel{position:fixed;inset:0;display:none;z-index:60}
.mobile-panel.active{display:block}
.mobile-dim{position:absolute;inset:0;background:#0008;animation:dimIn .2s}
@keyframes dimIn{from{opacity:0}to{opacity:1}}
.mobile-card{position:absolute;top:10px;right:10px;width:min(86vw,340px);background:linear-gradient(180deg,var(--card),var(--card-2));border:1px solid #24242a;border-radius:18px;padding:14px;box-shadow:var(--shadow);transform:translateY(-10px);opacity:0;animation:slideIn .22s forwards}
:root[data-theme="day"] .mobile-card{border-color:#cfe6b7}
@keyframes slideIn{to{transform:none;opacity:1}}
.mobile-links{display:grid;gap:10px;margin-top:8px}
.mobile-links a,.mobile-links button{text-align:left;background:transparent;color:var(--text);border:1px dashed #2b2b33;border-radius:12px;padding:12px 14px;font-weight:800}

/* LAYOUT */
.container{max-width:1100px;margin:0 auto;padding:28px 18px}
.hero{display:grid;grid-template-columns:1.1fr .9fr;gap:20px;align-items:center;padding:34px 0}
.card{
  background:linear-gradient(180deg,var(--card),var(--card-2));
  border:1px solid #24242a;border-radius:var(--radius);box-shadow:var(--shadow);padding:20px;
  position:relative;overflow:hidden;isolation:isolate;
  transition:transform var(--trans), box-shadow var(--trans), border-color var(--trans);
}
.card::after{ /* enchantment shimmer soft */
  content:""; position:absolute; inset:-40%; background:
  conic-gradient(from 0deg at 50% 50%, #ffffff12 0 10%, #00ff8830 10% 20%, #ffffff08 20% 30%, #00ff8830 30% 40%, transparent 40% 100%);
  filter:blur(12px); mix-blend-mode:overlay; opacity:.15; transform:rotate(0deg);
  animation:shimmer 18s linear infinite;
  pointer-events:none; z-index:-1;
}
@keyframes shimmer{to{transform:rotate(360deg)}}
.card:hover{transform:translateY(-2px); box-shadow:0 16px 40px rgba(0,0,0,.5)}
:root[data-theme="day"] .card{border-color:#cfe6b7}
.title{font-size:56px;line-height:1;margin:10px 0 6px;text-transform:uppercase;letter-spacing:.5px;background:var(--accent-grad);-webkit-background-clip:text;color:transparent;text-shadow:0 2px 0 #0006,2px 4px 0 #0004}
.subtitle{color:var(--muted);font-size:18px;margin:0 0 16px}
.cta{display:flex;gap:12px;flex-wrap:wrap}

h2.section-title{letter-spacing:1px;font-size:26px;margin:0 0 14px;background:var(--accent-grad);-webkit-background-clip:text;color:transparent}
.grid-cards{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
.project{grid-column:span 6;opacity:0;transform:translateY(16px)}
.placed{opacity:1;transform:translateY(0);transition:transform var(--trans),opacity var(--trans)}
.tag{font-size:12px;border-radius:999px;border:1px solid #2b2b33;padding:6px 10px;color:var(--text)}
footer{color:var(--muted);border-top:1px solid #24242a;margin-top:26px}

/* —— Input Minecrafty —— */
.input{width:100%; border:1px solid #2b2b33; border-radius:12px; background:var(--card);
  color:var(--text); padding:12px 14px; font-weight:700; outline:none; box-shadow:inset 0 -2px 0 #0006; transition:border-color var(--trans), box-shadow var(--trans)}
.input::placeholder{color:var(--muted)}
.input:focus{border-color:#39b439; box-shadow:0 0 0 3px #39b43933, inset 0 -2px 0 #0006}
.input.invalid{border-color:#c33; box-shadow:0 0 0 3px #c333}
.help{font: 12px/1.3 system-ui, sans-serif; color:var(--muted); margin-top:-6px; margin-bottom:4px}

/* HUD */
.hud{display:grid;gap:10px;margin-top:12px}
.hud-row{display:flex;align-items:center;gap:10px}
.hud-label{min-width:120px}
.bar{display:flex;gap:4px}
.heart,.armor,.hunger{width:18px;height:18px;background:#0000;position:relative;transition:filter var(--trans-fast)}
.heart::before{content:"";position:absolute;inset:0;background:radial-gradient(circle at 30% 35%,#f77 16%,#0000 17%),radial-gradient(circle at 70% 35%,#f77 16%,#0000 17%),linear-gradient(#f33 0 0) bottom/60% 40% no-repeat;filter:drop-shadow(0 2px 0 #0009)}
.armor::before{content:"";position:absolute;inset:0;background:linear-gradient(#ccd 0 0),linear-gradient(#ccd 0 0),linear-gradient(#ccd 0 0);background-size:100% 30%,70% 40%,40% 30%;background-position:top,center,bottom;background-repeat:no-repeat;filter:drop-shadow(0 2px 0 #0009)}
.hunger::before{content:"";position:absolute;inset:0;background:conic-gradient(from 45deg,#b05a00 0 25%,#0000 0),conic-gradient(from -45deg,#b05a00 0 25%,#0000 0);mask:radial-gradient(circle at 50% 20%,#000 28%,#0000 29%) top/100% 60% no-repeat, radial-gradient(circle at 50% 100%,#000 40%,#0000 41%) bottom/60% 40% no-repeat;filter:drop-shadow(0 2px 0 #0009)}
.empty{filter:grayscale(1) opacity(.35)}

/* Torch spotlight */
.spot-overlay{position:fixed;inset:0;pointer-events:none;opacity:0;transition:opacity var(--trans);z-index:40}
.spot-overlay.active{opacity:1}
.spot-overlay::before{content:"";position:absolute;inset:0;background:radial-gradient(circle var(--spot-size) at var(--spot-x) var(--spot-y), transparent 0, transparent 55%, var(--dim) 60%)}

/* Timeline */
.timeline{position:relative;padding-left:24px}
.timeline::before{content:"";position:absolute;left:8px;top:0;bottom:0;width:4px;background:linear-gradient(#2a2a2f,#39b43955)}
.tl-item{position:relative;margin:14px 0;padding-left:8px}
.tl-item::before{content:"";position:absolute;left:-2px;top:6px;width:12px;height:12px;background:var(--accent);border:2px solid #0d1;border-radius:4px;box-shadow:0 0 0 2px #0006}

/* GALERI */
.gallery-grid{display:grid; gap:12px; grid-template-columns:repeat(auto-fit, minmax(180px, 1fr)); align-items:stretch}
.gallery-item{position:relative; overflow:hidden; border-radius:16px; background:#0d0d0f; border:1px solid #24242a; aspect-ratio: 4 / 3; display:block; transition:transform var(--trans), border-color var(--trans)}
.gallery-item>img{width:100%; height:100%; display:block; object-fit:cover; object-position:center; image-rendering:auto; transition:transform .6s var(--ease-cine)}
.gallery-item:hover>img{ transform:scale(1.05) }
@media (min-width:1200px){
  .gallery-grid{grid-template-columns:repeat(12, 1fr)}
  .gallery-item.span-6{grid-column:span 6}
  .gallery-item.span-4{grid-column:span 4}
  .gallery-item.span-3{grid-column:span 3}
}

/* Responsive */
@media (max-width:980px){
  .hero{grid-template-columns:1fr}
  .project{grid-column:span 12}
  .title{font-size:44px}
  .links{display:none}
  .menu-toggle{display:inline-flex;align-items:center;gap:10px}
}
@media (orientation:portrait){ .gallery-grid{grid-auto-flow:dense} }
@media (orientation:landscape){ .container{padding:22px 18px} .gallery-item{aspect-ratio: 3 / 2} }

/* Lightbox */
.lightbox{position:fixed;inset:0;background:#0006;backdrop-filter:blur(var(--blur));display:none;place-items:center;z-index:80;transition:opacity var(--trans-slow)}
.lightbox.active{display:grid;animation:lbIn .28s var(--ease-cine)}
@keyframes lbIn{from{opacity:0}to{opacity:1}}
.lightbox img{max-width:92vw;max-height:82vh;image-rendering:auto;border-radius:16px;box-shadow:var(--shadow);transform:scale(.96);opacity:0;animation:imgIn .3s var(--ease-cine) forwards}
@keyframes imgIn{to{transform:scale(1);opacity:1}}
.lightbox .close{position:absolute;top:16px;right:16px}

/* KPIs (kept minimal) */
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.kpi{display:grid;gap:6px;text-align:center}
.kpi .num{font-size:32px;letter-spacing:1px;background:var(--accent-grad);-webkit-background-clip:text;color:transparent}
@media (max-width:640px){ .kpis{grid-template-columns:1fr 1fr} }

/* Walker */
.walker{position:fixed;left:-64px;bottom:10px;width:48px;height:48px;z-index:5;animation:walk 14s linear infinite}
@keyframes walk{from{transform:translateX(-60px)}to{transform:translateX(calc(100vw + 60px))}}

/* Break overlay (smoothed) */
.break-overlay{position:fixed;inset:0;pointer-events:none;display:none}
.break-overlay.active{display:grid;grid-template-columns:repeat(20,1fr);grid-auto-rows:5vh;z-index:60}
.break-tile{background:#2a2a2f;transform:scale(1);opacity:1;animation:crumble .6s var(--ease) forwards}
@keyframes crumble{to{transform:translateY(40vh) rotate(15deg) scale(.9);opacity:0}}

/* XP bar + toast */
.xp-wrap{position:fixed;left:50%;transform:translateX(-50%);bottom:10px;z-index:70;display:grid;gap:6px;place-items:center}
.xp-bar{width:min(600px,86vw);height:14px;border-radius:10px;background:#0a2c0a;box-shadow:inset 0 2px 0 #0008;overflow:hidden}
.xp-fill{height:100%;width:0%;background:linear-gradient(90deg,#3ad33a,#2ea62e);border-radius:10px;transition:width .35s var(--ease-cine)}
.level-tag{font-weight:800;text-shadow:0 2px 0 #0006}
.toast{position:fixed;top:16px;left:50%;transform:translateX(-50%);background:#111c;backdrop-filter:blur(6px);color:#fff;border:1px solid #2a2a2f;border-radius:12px;padding:10px 14px;z-index:90;display:none}
.toast.show{display:block;animation:toastIn .25s ease, toastOut .25s ease 2.5s forwards}
@keyframes toastIn{from{opacity:0;transform:translate(-50%,-10px)}to{opacity:1;transform:translate(-50%,0)}}
@keyframes toastOut{to{opacity:0;transform:translate(-50%,-10px)}}

/* Command */
.cmd{position:fixed;right:14px;bottom:14px;z-index:75;display:grid;gap:6px}
.cmd input{border-radius:12px;border:1px solid #2b2b33;background:var(--card);color:var(--text);padding:10px 12px;font-weight:700;min-width:240px;transition:box-shadow var(--trans)}

/* Ambient badge */
.badges{display:flex;gap:8px;flex-wrap:wrap}
.badge{display:inline-grid;grid-auto-flow:column;gap:8px;align-items:center;font-size:12px;color:#0b270b;background:#c9f5c9;padding:6px 10px;border-radius:999px;font-weight:700;letter-spacing:.3px}

/* Skin picker */
.skin-picker{display:flex;gap:8px;align-items:center}
.skin{width:18px;height:18px;border-radius:4px;cursor:pointer;border:1px solid #0006;box-shadow:inset 0 -2px 0 #0006;transition:transform var(--trans-fast)}
.skin:hover{transform:translateY(-2px)}

/* —— Map frame pixel —— */
.map-frame{border-radius:16px; overflow:hidden; border:1px solid #24242a; box-shadow:var(--shadow); transition:border-color var(--trans)}
.map-frame::after{
  content:""; display:block; height:6px; background:
  repeating-linear-gradient(90deg,#2b2b33 0 8px,#1b1b20 8px 16px);
}

/* ===== Smooth reveal (fade+slide) ===== */
.reveal{opacity:0; transform:translateY(14px); will-change:opacity,transform; filter:saturate(90%)}
.reveal.show{opacity:1; transform:none; transition:opacity .6s var(--ease-cine), transform .6s var(--ease-cine), filter .6s var(--ease-cine); filter:saturate(100%)}

/* ===== Loader (cinematic) ===== */
.loader{
  position:fixed; inset:0; display:grid; place-items:center; z-index:120;
  background:radial-gradient(1200px 600px at 50% 80%, #0000 40%, #000a 100%), var(--bg);
}
.loader-inner{display:grid;gap:14px;place-items:center; text-align:center}
.loader-title{font-size:20px; letter-spacing:1px}
.progress{width:min(520px,82vw); height:14px; border-radius:999px; background:#0a2c0a; box-shadow:inset 0 2px 0 #0008; overflow:hidden}
.progress-fill{height:100%; width:0%; background:linear-gradient(90deg,#3ad33a,#2ea62e); transition:width .28s var(--ease-cine)}
.loader.fade-out{animation:fadeOut .6s var(--ease-cine) forwards}
@keyframes fadeOut{to{opacity:0; visibility:hidden}}

/* ===== Torch Flicker (subtle, random) ===== */
.torch-glow-ambient{
  position:fixed; inset:0; pointer-events:none; z-index:39; mix-blend-mode:screen; opacity:.3;
  background: radial-gradient(400px 240px at var(--spot-x) var(--spot-y), #3ad33a22 0, #0000 60%);
  transition:opacity var(--trans);
}

/* ===== Inventory Modal (smooth) ===== */
.modal{position:fixed;inset:0;display:none;place-items:center;z-index:85;background:#0006;backdrop-filter:blur(var(--blur))}
.modal.active{display:grid;animation:lbIn .28s var(--ease-cine)}
.modal-card{background:linear-gradient(180deg,var(--card),var(--card-2)); border:1px solid #24242a; border-radius:16px; padding:16px; width:min(620px,90vw); transform:scale(.96); opacity:0; animation:imgIn .3s var(--ease-cine) forwards}
.modal-head{display:flex;align-items:center;justify-content:space-between;gap:10px; margin-bottom:10px}

/* ===== Floating XP orbs (subtle idle) ===== */
@keyframes floatOrb{
  0%{ transform:translateY(0) }
  50%{ transform:translateY(-6px) }
  100%{ transform:translateY(0) }
}
.xp-wrap{animation:floatOrb 4.5s cubic-bezier(.33,1,.68,1) infinite}

/* ===== Section separators ===== */
.section-fade{
  position:relative;
}
.section-fade::before{
  content:""; position:absolute; left:0; right:0; top:-16px; height:16px;
  background:linear-gradient(to bottom, #0000, #0003);
  pointer-events:none;
}

/* ===== Subtle shadow-lift on focus ===== */
a:focus-visible, button:focus-visible, .input:focus-visible{
  outline:2px solid #39b439; outline-offset:2px;
  filter:drop-shadow(0 4px 10px #39b43933);
  transition:filter var(--trans-fast);
}
</style>
</head>
<body>
  <!-- GRID + PARALLAX -->
  <div class="grid" aria-hidden="true"></div>
  <div class="parallax" aria-hidden="true">
    <div class="layer l1"></div><div class="layer l2"></div><div class="layer l3"></div>
  </div>

  <!-- Torch spotlight -->
  <div class="torch-glow-ambient" aria-hidden="true"></div>
  <div class="spot-overlay" id="spot" aria-hidden="true"></div>

  <!-- Walker -->
  <svg class="walker" viewBox="0 0 16 16" style="image-rendering:pixelated" aria-hidden="true" id="walker">
    <rect width="16" height="16" fill="#0000"/>
    <rect x="6" y="1" width="4" height="4" class="skin-head" fill="#f1c27d"/>
    <rect x="5" y="5" width="6" height="5" class="skin-body" fill="#3aa"/>
    <rect x="4" y="5" width="2" height="4" class="skin-arm" fill="#f1c27d"/>
    <rect x="10" y="5" width="2" height="4" class="skin-arm" fill="#f1c27d"/>
    <rect x="5" y="10" width="2" height="4" class="skin-leg" fill="#36a"/>
    <rect x="9" y="10" width="2" height="4" class="skin-leg" fill="#36a"/>
  </svg>

  <!-- NAV -->
  <header>
    <nav class="nav">
      <a class="brand pix-hover" href="#beranda" data-scroll="#beranda">
        <div class="logo" aria-hidden="true">🧱</div>
        <span class="brand-title">PORTOFOLIO</span>
      </a>
      <div class="links" aria-label="Navigasi utama">
        <a class="link pix-hover" data-scroll="#tentang" href="#tentang">Tentang</a>
        <a class="link pix-hover" data-scroll="#proyek" href="#proyek">Proyek</a>
        <a class="link pix-hover" data-scroll="#galeri" href="#galeri">Galeri</a>
        <a class="link pix-hover" data-scroll="#kontak" href="#kontak">Kontak</a>
        <button id="themeBtn" class="btn btn-ghost pix-hover" type="button">🌗 Mode</button>
        <button id="musicBtn" class="btn btn-ghost pix-hover" type="button" aria-pressed="false">🎵 Musik</button>
      </div>
      <button id="menuBtn" class="menu-toggle pix-hover" type="button" aria-label="Buka menu" aria-controls="mobilePanel" aria-expanded="false">
        <span class="bars" aria-hidden="true"><i></i><i></i><i></i></span>
        <span class="sr-only" style="position:absolute;clip:rect(0,0,0,0);width:1px;height:1px;overflow:hidden">Menu</span>
      </button>
    </nav>
  </header>

  <!-- Mobile Panel -->
  <div id="mobilePanel" class="mobile-panel" hidden>
    <div class="mobile-dim" data-close></div>
    <div class="mobile-card" role="dialog" aria-modal="true" aria-label="Menu">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
        <strong style="letter-spacing:.5px">MENU</strong>
        <button class="btn btn-ghost pix-hover" type="button" data-close>✕</button>
      </div>
      <nav class="mobile-links" id="mobileLinks">
        <a class="pix-hover" href="#tentang" data-scroll="#tentang" data-close>📦 Tentang</a>
        <a class="pix-hover" href="#proyek" data-scroll="#proyek" data-close>🧰 Proyek</a>
        <a class="pix-hover" href="#galeri" data-scroll="#galeri" data-close>🖼️ Galeri</a>
        <a class="pix-hover" href="#kontak" data-scroll="#kontak" data-close>📫 Kontak</a>
        <button id="themeBtnMobile" class="pix-hover" type="button">🌗 Mode</button>
        <button id="musicBtnMobile" class="pix-hover" type="button" aria-pressed="false">🎵 Musik</button>
      </nav>
    </div>
  </div>

  <!-- LOADER (CINEMATIC) -->
  <div id="loader" class="loader" aria-live="polite">
    <div class="loader-inner">
      <div class="loader-title">Generating World…</div>
      <div class="progress"><div id="progressFill" class="progress-fill"></div></div>
      <small class="muted">Loading Chunks & Shaders</small>
    </div>
  </div>

  <!-- BREAK + LIGHTBOX -->
  <div class="break-overlay" id="break"></div>
  <div id="lightbox" class="lightbox" aria-hidden="true">
    <button class="btn btn-ghost pix-hover close" type="button">✕</button>
    <img alt="preview">
  </div>

  <!-- MAIN -->
  <main class="container section-fade" id="beranda">
    <!-- HERO -->
    <section class="hero reveal">
      <article class="card placeable" style="position:relative">
        <div class="badges">
          <span class="badge">⛏️ Minecraft UI</span>
          <span class="badge" id="biomeBadge">🌿 Forest</span>
        </div>
        <h1 class="title">Ahmad<br/>Albar</h1>
        <p class="subtitle">Web developer yang suka tampilan pixel-art. Spesialis landing page cepat, UI minimalis, dan animasi halus.</p>
        <div class="cta">
          <a class="btn btn-primary pix-hover" data-scroll="#proyek" href="#proyek">Lihat Proyek</a>
          <a class="btn btn-ghost pix-hover" data-scroll="#kontak" href="#kontak">Hubungi Saya</a>
        </div>
        <div class="hud" id="hud" style="margin-top:14px">
          <div class="hud-row" data-type="heart" data-label="Frontend" data-value="8" data-max="10"><span class="hud-label">Frontend</span><div class="bar"></div></div>
          <div class="hud-row" data-type="heart" data-label="Backend" data-value="6" data-max="10"><span class="hud-label">Backend</span><div class="bar"></div></div>
          <div class="hud-row" data-type="armor" data-label="UI/UX" data-value="7" data-max="10"><span class="hud-label">UI/UX</span><div class="bar"></div></div>
          <div class="hud-row" data-type="hunger" data-label="Hunger" data-value="9" data-max="10"><span class="hud-label">Hunger</span><div class="bar"></div></div>
        </div>
        <div class="skin-picker" style="margin-top:10px">
          <small class="muted">Skin:</small>
          <span class="skin" data-skin='{"head":"#f1c27d","body":"#3aa","leg":"#36a"}' style="background:#3aa" title="Default"></span>
          <span class="skin" data-skin='{"head":"#e0b07a","body":"#a33","leg":"#733"}' style="background:#a33" title="Warrior"></span>
          <span class="skin" data-skin='{"head":"#f1c27d","body":"#3a3","leg":"#262"}' style="background:#3a3" title="Ranger"></span>
          <span class="skin" data-skin='{"head":"#f1c27d","body":"#555","leg":"#222"}' style="background:#555" title="Miner"></span>
        </div>
      </article>

      <aside aria-label="Ikon Pixel" class="card placeable" style="display:grid;place-items:center">
        <svg viewBox="0 0 32 32" width="220" height="220" style="image-rendering:pixelated" aria-hidden="true">
          <rect width="32" height="32" fill="#0000"/>
          <rect x="12" y="2" width="8" height="4" fill="#654321"/>
          <rect x="10" y="6" width="12" height="4" fill="#8b5a2b"/>
          <rect x="8" y="10" width="16" height="4" fill="#a67c52"/>
          <rect x="15" y="14" width="2" height="16" fill="#6b3e20"/>
          <rect x="13" y="18" width="6" height="6" fill="#39b439"/>
        </svg>
        <div class="kpis" style="margin-top:12px">
          <div class="kpi card"><div class="num" data-count="24">0</div><small class="muted">Proyek</small></div>
          <div class="kpi card"><div class="num" data-count="18">0</div><small class="muted">Klien</small></div>
          <div class="kpi card"><div class="num" data-count="100">0</div><small class="muted">Skor Lighthouse</small></div>
        </div>
      </aside>
    </section>

    <!-- TENTANG -->
    <section id="tentang" class="card placeable reveal">
      <h2 class="section-title">📦 Tentang Saya</h2>
      <p>Halo! Saya <strong>Nama Kamu</strong>. Saya membangun website responsif dengan karakter visual unik. Fokus pada UX, aksesibilitas, dan performa.</p>
      <div class="timeline" style="margin-top:14px">
        <div class="tl-item reveal"><strong>2025</strong> — Merilis <em>Pixel Storefront</em> (e-commerce bertema pixel-art).</div>
        <div class="tl-item reveal"><strong>2024</strong> — Buat peta interaktif <em>World Explorer</em>.</div>
        <div class="tl-item reveal"><strong>2023</strong> — Landing page <em>Speedrun</em> skor 100/100.</div>
      </div>
    </section>

    <!-- PROYEK -->
    <section id="proyek" class="card placeable reveal">
      <h2 class="section-title">🧰 Proyek Pilihan</h2>
      <div class="grid-cards">
        <article class="card project pix-hover reveal"><small class="muted">2025</small><h3 style="margin:6px 0 8px">Pixel Storefront</h3><p class="subtitle">Toko online bertema pixel-art dengan keranjang dinamis & checkout terintegrasi.</p><div class="tags"><span class="tag">Next.js</span><span class="tag">Stripe</span><span class="tag">Motion</span></div></article>
        <article class="card project pix-hover reveal"><small class="muted">2024</small><h3 style="margin:6px 0 8px">World Explorer</h3><p class="subtitle">Peta interaktif hiking — UI grid “blok” terinspirasi voxel.</p><div class="tags"><span class="tag">Vue</span><span class="tag">Mapbox</span><span class="tag">Vite</span></div></article>
        <article class="card project pix-hover reveal"><small class="muted">2024</small><h3 style="margin:6px 0 8px">Crafted Docs</h3><p class="subtitle">Sistem dokumentasi internal dengan mode gelap & pencarian cepat.</p><div class="tags"><span class="tag">Docusaurus</span><span class="tag">Algolia</span></div></article>
        <article class="card project pix-hover reveal"><small class="muted">2023</small><h3 style="margin:6px 0 8px">Speedrun Landing</h3><p class="subtitle">Landing page ringan, skor Lighthouse 100/100, micro-interaction.</p><div class="tags"><span class="tag">Astro</span><span class="tag">Vanilla CSS</span></div></article>
      </div>
    </section>

    <!-- GALERI -->
    <section id="galeri" class="card placeable reveal">
      <h2 class="section-title">🖼️ Galeri</h2>
      <div class="gallery-grid">
        <a class="gallery-item span-6 lb" href="https://picsum.photos/seed/pixel1/1200/800" aria-label="Buka gambar 1">
          <img loading="lazy" src="https://picsum.photos/seed/pixel1/600/400" alt="Project 1" width="600" height="400">
        </a>
        <a class="gallery-item span-3 lb" href="https://picsum.photos/seed/pixel2/1200/800" aria-label="Buka gambar 2">
          <img loading="lazy" src="https://picsum.photos/seed/pixel2/600/400" alt="Project 2" width="600" height="400">
        </a>
        <a class="gallery-item span-3 lb" href="https://picsum.photos/seed/pixel3/1200/800" aria-label="Buka gambar 3">
          <img loading="lazy" src="https://picsum.photos/seed/pixel3/600/400" alt="Project 3" width="600" height="400">
        </a>
        <a class="gallery-item span-4 lb" href="https://picsum.photos/seed/pixel4/1200/800" aria-label="Buka gambar 4">
          <img loading="lazy" src="https://picsum.photos/seed/pixel4/600/400" alt="Project 4" width="600" height="400">
        </a>
        <a class="gallery-item span-4 lb" href="https://picsum.photos/seed/pixel5/1200/800" aria-label="Buka gambar 5">
          <img loading="lazy" src="https://picsum.photos/seed/pixel5/600/400" alt="Project 5" width="600" height="400">
        </a>
        <a class="gallery-item span-4 lb" href="https://picsum.photos/seed/pixel6/1200/800" aria-label="Buka gambar 6">
          <img loading="lazy" src="https://picsum.photos/seed/pixel6/600/400" alt="Project 6" width="600" height="400">
        </a>
      </div>
    </section>

    <!-- KONTAK -->
    <section id="kontak" class="card placeable reveal">
      <h2 class="section-title">📫 Kontak</h2>
      <form id="contactForm" class="pix-hover" style="display:grid;gap:10px" novalidate>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
          <div>
            <label for="fNama" class="help">Nama</label>
            <input id="fNama" class="input" type="text" name="nama" placeholder="Steve / Alex" required minlength="2" />
          </div>
          <div>
            <label for="fEmail" class="help">Email</label>
            <input id="fEmail" class="input" type="email" name="email" placeholder="kamu@mail.com" required />
          </div>
        </div>
        <div>
          <label for="fSubjek" class="help">Subjek</label>
          <input id="fSubjek" class="input" type="text" name="subjek" placeholder="Mau bikin landing page pixel-art" required />
        </div>
        <div>
          <label for="fPesan" class="help">Pesan</label>
          <textarea id="fPesan" class="input" name="pesan" placeholder="Ceritakan kebutuhanmu secara singkat..." required style="min-height:140px"></textarea>
        </div>
        <div class="help">Estimasi balasan &lt; 24 jam kerja. Atau pakai WhatsApp untuk cepat.</div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn btn-primary pix-hover sfx-click" type="submit">📬 Kirim (Simulasi)</button>
          <button id="waBtn" class="btn btn-ghost pix-hover" type="button">🟢 Kirim via WhatsApp</button>
          <button id="copyBtn" class="btn btn-ghost pix-hover" type="button">📋 Salin Ringkasan</button>
          <button id="invBtn" class="btn btn-ghost pix-hover" type="button">🎒 Inventory</button>
        </div>
      </form>
    </section>

    <!-- MAP -->
    <section class="card placeable reveal">
      <h2 class="section-title">🗺️ Lokasi</h2>
      <div class="map-frame">
        <div id="map" style="height:340px"></div>
      </div>
    </section>

    <footer class="container" style="padding-left:0;padding-right:0">
      <p>© <span id="y"></span> Nama Kamu — Dibuat dengan ❤ dan font Minecrafter.</p>
    </footer>
  </main>

  <!-- XP + Toast + Chat -->
  <div class="xp-wrap" aria-live="polite">
    <div class="level-tag">Lvl <span id="lvl">1</span></div>
    <div class="xp-bar"><div class="xp-fill" id="xpFill"></div></div>
  </div>
  <div class="toast" id="toast">Achievement Unlocked!</div>
  <div class="cmd" aria-label="Chat Command">
    <input id="cmd" placeholder="/about, /projects, /contact, /torch, /biome desert, /creeper" aria-label="Input perintah" />
    <small class="muted">Ketik perintah lalu Enter</small>
  </div>

  <!-- Inventory Modal -->
  <div id="invModal" class="modal" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-head">
        <strong>🎒 Inventory</strong>
        <button type="button" class="btn btn-ghost pix-hover" data-close-inv>✕</button>
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px">
        <div class="card">🪓 Kapak Pixel</div>
        <div class="card">🧭 Kompas</div>
        <div class="card">💎 Diamond</div>
        <div class="card">🧪 Potion</div>
      </div>
    </div>
  </div>

<script>
/* ========= Konfigurasi ========= */
const PHONE_NUMBER = '6285822902866';

/* ========= Utils ========= */
const $ = (q,sc=document)=>sc.querySelector(q); const $$=(q,sc=document)=>[...sc.querySelectorAll(q)];
const root=document.documentElement; const body=document.body;
const biomeList=['forest','desert','snow','mesa','swamp'];

/* Year */
$('#y').textContent = new Date().getFullYear();

/* ===== Theme: auto by time + toggle ===== */
(function initTheme(){
  const saved=localStorage.getItem('theme');
  if(saved){ root.setAttribute('data-theme',saved); return; }
  const h=new Date().getHours(); // auto
  const mode=(h>=6 && h<18)?'day':'night';
  root.setAttribute('data-theme',mode);
})();
const setTheme=(now)=>{root.setAttribute('data-theme',now);localStorage.setItem('theme',now)};
$('#themeBtn')?.addEventListener('click',()=>setTheme(root.getAttribute('data-theme')==='day'?'night':'day'));
$('#themeBtnMobile')?.addEventListener('click',()=>setTheme(root.getAttribute('data-theme')==='day'?'night':'day'));

/* ===== Random Biome + Ambient ===== */
function pickBiome(b){
  body.classList.remove(...biomeList.map(x=>`biome-${x}`));
  body.classList.add(`biome-${b}`);
  $('#biomeBadge').textContent = {forest:'🌿 Forest', desert:'🏜️ Desert', snow:'❄️ Snow', mesa:'🏜️ Mesa', swamp:'🪵 Swamp'}[b]||'Biome';
  setAmbient(b);
}
function randomBiome(){ return biomeList[Math.floor(Math.random()*biomeList.length)] }

/* ===== Ambient audio ===== */
const ambient = new Audio(); ambient.loop=true; ambient.volume=0.25; ambient.preload='none';
const ambientSrc = {
  forest:'https://cdn.pixabay.com/download/audio/2022/03/15/audio_c9f4a0b2d1.mp3?filename=forest-nature-ambient-105453.mp3',
  desert:'https://cdn.pixabay.com/download/audio/2022/03/15/audio_9a2c8f8d3b.mp3?filename=wind-ambient-105452.mp3',
  snow:'https://cdn.pixabay.com/download/audio/2021/09/06/audio_3a8a9e02e3.mp3?filename=wind-whoosh-90991.mp3',
  mesa:'https://cdn.pixabay.com/download/audio/2022/02/23/audio_4f0a8d9c58.mp3?filename=lofi-study-112191.mp3',
  swamp:'https://cdn.pixabay.com/download/audio/2022/10/19/audio_3b8aa9f3c1.mp3?filename=crickets-ambient-124438.mp3'
};
function setAmbient(b){ ambient.src = ambientSrc[b]||ambientSrc.forest; if(!music.paused) { ambient.play().catch(()=>{}); } }

/* ===== Music main toggle ===== */
const music = new Audio('https://cdn.pixabay.com/download/audio/2022/02/23/audio_4f0a8d9c58.mp3?filename=lofi-study-112191.mp3');
music.loop=true; music.volume=0.18; music.preload='none';
function toggleMusic(btn){ if(music.paused){ music.play(); ambient.play().catch(()=>{}); btn.setAttribute('aria-pressed','true'); btn.textContent='🔇 Matikan Musik';}
  else { music.pause(); ambient.pause(); btn.setAttribute('aria-pressed','false'); btn.textContent='🎵 Musik'; } }
$('#musicBtn')?.addEventListener('click',e=>toggleMusic(e.currentTarget));
$('#musicBtnMobile')?.addEventListener('click',e=>toggleMusic(e.currentTarget));

/* ===== Parallax ===== */
const layers=$$('.layer'); window.addEventListener('scroll',()=>{const y=window.scrollY;layers.forEach((l,i)=>{const speed=(i+1)*0.06;l.style.transform=`translateY(${y*speed}px)`})});

/* ===== Loader (smooth) ===== */
const loader = $('#loader'); const pf = $('#progressFill');
let prog = 0; const fakeLoad = setInterval(()=>{ prog += Math.max(1, Math.floor(Math.random()*6)); if(prog>100) prog=100; pf.style.width = prog + '%';
  if(prog>=100){ clearInterval(fakeLoad); loader.classList.add('fade-out'); setTimeout(()=>loader.remove(),650); }
}, 120);

/* ===== Break + smooth scroll ===== */
const breaker=$('#break');
function blockBreak(cb){breaker.innerHTML='';breaker.classList.add('active');
  for(let i=0;i<300;i++){const t=document.createElement('div');t.className='break-tile';t.style.animationDelay=(Math.random()*0.25)+'s';breaker.appendChild(t)}
  setTimeout(()=>{breaker.classList.remove('active');breaker.innerHTML='';cb&&cb()},620)
}
function smoothTo(el){blockBreak(()=>el.scrollIntoView({behavior:'smooth',block:'start'}))}
$$('[data-scroll]').forEach(a=>{
  a.addEventListener('click',e=>{
    if(a.tagName==='A')e.preventDefault();
    const target=document.querySelector(a.dataset.scroll); if(!target)return;
    sfxClick(); smoothTo(target); if(a.hasAttribute('data-close'))closeMenu()
  })
});

/* ===== Reveal (scroll) & Place SFX ===== */
const revObs=new IntersectionObserver(ents=>{
  ents.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('show'); revObs.unobserve(e.target) }})
},{threshold:.18});
$$('.reveal').forEach(el=>revObs.observe(el));
const placeObs=new IntersectionObserver(ents=>{
  ents.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('placed'); sfxPlace(); placeObs.unobserve(e.target) }})
},{threshold:.2});
$$('.placeable,.project').forEach(el=>placeObs.observe(el));

/* ===== HUD build ===== */
function buildHUD(){ $$('#hud .hud-row').forEach(row=>{
  const type=row.dataset.type,val=+row.dataset.value,max=+row.dataset.max; const bar=row.querySelector('.bar'); bar.innerHTML='';
  for(let i=0;i<max;i++){ const s=document.createElement('span'); s.className=(type==='heart'?'heart':type==='armor'?'armor':'hunger')+(i<val?'':' empty'); bar.appendChild(s) }
})}
buildHUD();

/* ===== Counters ===== */
const counterObs=new IntersectionObserver(ents=>{
  ents.forEach(e=>{
    if(!e.isIntersecting)return;
    const end=+e.target.dataset.count||0; let cur=0;
    const inc=Math.max(1,Math.floor(end/80));
    const t=setInterval(()=>{cur+=inc;if(cur>=end){cur=end;clearInterval(t)}e.target.textContent=cur},16);
    counterObs.unobserve(e.target)
  })
},{threshold:.5});
$$('.num[data-count]').forEach(el=>counterObs.observe(el));

/* ===== Lightbox ===== */
const lb=$('#lightbox'); const lbImg=lb.querySelector('img');
function openLB(src){lbImg.src=src;lb.classList.add('active')}
function closeLB(){lb.classList.remove('active')}
$$('.lb').forEach(a=>{a.addEventListener('click',e=>{e.preventDefault();openLB(a.getAttribute('href'))})});
lb.addEventListener('click',e=>{if(e.target===lb||e.target.classList.contains('close'))closeLB()});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeLB()});

/* ===== Contact + WhatsApp ===== */
function formToMessage(f){
  const nama=f.nama.value.trim();
  const email=f.email.value.trim();
  const subjek=f.subjek.value.trim();
  const pesan=f.pesan.value.trim();
  return `Halo, saya ${nama} (${email}).%0A%0ASubjek: ${subjek}%0A%0APesan:%0A${pesan}`;
}
function validateForm(f){
  let ok=true;
  $$('input,textarea', f).forEach(el=>el.classList.remove('invalid'));
  if(f.nama.value.trim().length<2){ f.nama.classList.add('invalid'); ok=false; }
  if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.email.value.trim())){ f.email.classList.add('invalid'); ok=false; }
  if(!f.subjek.value.trim()){ f.subjek.classList.add('invalid'); ok=false; }
  if(!f.pesan.value.trim()){ f.pesan.classList.add('invalid'); ok=false; }
  return ok;
}
$('#contactForm').addEventListener('submit',e=>{
  e.preventDefault();
  const f=e.currentTarget;
  if(!validateForm(f)){ toast('Cek lagi kolom merah ya.'); return; }
  toast('Pesan terkirim (simulasi) 📬'); grantXP(10);
});
$('#waBtn').addEventListener('click',()=>{
  const f=$('#contactForm');
  if(!validateForm(f)){ toast('Isi form dulu ya biar rapi ke WhatsApp.'); return; }
  const text=formToMessage(f);
  window.open(`https://wa.me/${PHONE_NUMBER}?text=${text}`,'_blank');
  grantXP(5);
});
$('#copyBtn').addEventListener('click',async()=>{
  const f=$('#contactForm');
  if(!validateForm(f)){ toast('Lengkapi form dulu untuk disalin.'); return; }
  const raw=`Nama: ${f.nama.value.trim()}
Email: ${f.email.value.trim()}
Subjek: ${f.subjek.value.trim()}
Pesan:
${f.pesan.value.trim()}`;
  try{ await navigator.clipboard.writeText(raw); toast('Ringkasan disalin 📋'); grantXP(2); }catch{ toast('Gagal menyalin.'); }
});

/* ===== Inventory Modal ===== */
const invModal = $('#invModal');
$('#invBtn').addEventListener('click',()=>{ invModal.classList.add('active'); grantXP(2) });
$('[data-close-inv]').addEventListener('click',()=>invModal.classList.remove('active'));
invModal.addEventListener('click',e=>{ if(e.target===invModal) invModal.classList.remove('active') });
document.addEventListener('keydown',e=>{ if(e.key==='Escape') invModal.classList.remove('active') });

/* ===== Map (Leaflet) ===== */
function initMap(){
  const map=L.map('map',{zoomControl:true}).setView([-6.2,106.816],12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'&copy; OpenStreetMap'}).addTo(map);
  L.marker([-6.2,106.816]).addTo(map).bindPopup('Lokasi contoh 📍');
}
window.addEventListener('load',()=>setTimeout(initMap,120));

/* ===== Web Audio SFX ===== */
const ctx=new (window.AudioContext||window.webkitAudioContext)();
function beep(freq,time,type='sine',gain=0.04){const o=ctx.createOscillator();const g=ctx.createGain();o.type=type;o.frequency.value=freq;o.connect(g);g.connect(ctx.destination);const now=ctx.currentTime;g.gain.setValueAtTime(gain,now);g.gain.exponentialRampToValueAtTime(0.0001,now+time);o.start();o.stop(now+time)}
function sfxClick(){if(ctx.state==='suspended')ctx.resume();beep(880,.06,'triangle',.06);setTimeout(()=>beep(1320,.06,'triangle',.05),60)}
function sfxPlace(){if(ctx.state==='suspended')ctx.resume();beep(220,.05,'square',.03);setTimeout(()=>beep(330,.05,'square',.02),55)}
function sfxRedstone(){if(ctx.state==='suspended')ctx.resume();beep(440,.05,'square',.05)}
$$('.pix-hover,.sfx-click').forEach(el=>{el.addEventListener('click',sfxClick);el.addEventListener('mouseenter',()=>{if(ctx.state==='suspended')ctx.resume()})});

/* ===== Hamburger a11y ===== */
const menuBtn=$('#menuBtn'); const panel=$('#mobilePanel'); let lastFocused=null;
function openMenu(){lastFocused=document.activeElement;panel.hidden=false;requestAnimationFrame(()=>panel.classList.add('active'));menuBtn.setAttribute('aria-expanded','true');const first=panel.querySelector('#mobileLinks a,#mobileLinks button');first&&first.focus();document.documentElement.style.scrollBehavior='auto';document.body.style.overflow='hidden'}
function closeMenu(){panel.classList.remove('active');menuBtn.setAttribute('aria-expanded','false');setTimeout(()=>{panel.hidden=true},200);document.body.style.overflow='';lastFocused&&lastFocused.focus();document.documentElement.style.scrollBehavior=''}
menuBtn.addEventListener('click',()=>menuBtn.getAttribute('aria-expanded')==='true'?closeMenu():openMenu());
panel.addEventListener('click',e=>{if(e.target.hasAttribute('data-close'))closeMenu()});
document.addEventListener('keydown',e=>{if(panel.hidden)return;if(e.key==='Escape'){e.preventDefault();closeMenu()}if(e.key==='Tab'){const f=panel.querySelectorAll('a,button,[tabindex]:not([tabindex="-1"])');if(!f.length)return;const first=f[0],last=f[f.length-1];if(e.shiftKey&&document.activeElement===first){e.preventDefault();last.focus()}else if(!e.shiftKey&&document.activeElement===last){e.preventDefault();first.focus()}}});

/* ===== Torch spotlight control (with random flicker) ===== */
const spot=$('#spot'); let torchOn=false;
function setSpotFromEvent(e){
  root.style.setProperty('--spot-x', (e.clientX||innerWidth*0.5)+"px");
  root.style.setProperty('--spot-y', (e.clientY||innerHeight*0.3)+"px");
}
function flickerLoop(){
  if(!torchOn) return;
  const size = 160 + Math.random()*80;
  root.style.setProperty('--spot-size', size+'px');
  requestAnimationFrame(()=>setTimeout(flickerLoop, 90 + Math.random()*180));
}
function toggleTorch(){torchOn=!torchOn; spot.classList.toggle('active',torchOn);
  $('.torch-glow-ambient').style.opacity = torchOn? .42 : .3;
  if(torchOn){ spot.style.pointerEvents='none'; document.addEventListener('mousemove',setSpotFromEvent); toast('Torch Mode 🔦'); flickerLoop(); }
  else { document.removeEventListener('mousemove',setSpotFromEvent); }
}
// clickable torch button in nav
const torchEl = document.createElement('button'); torchEl.textContent='🔦 Torch'; torchEl.className='btn btn-ghost pix-hover'; torchEl.style.marginLeft='8px';
$('.links')?.appendChild(torchEl); torchEl.addEventListener('click',()=>{toggleTorch(); sfxRedstone();});

/* ===== XP System & Achievements ===== */
let level=1, xp=0, next=50; const xpFill=$('#xpFill'); const lvlTag=$('#lvl');
function renderXP(){ xpFill.style.width = Math.min(100, (xp/next)*100) + '%'; lvlTag.textContent=level; }
function grantXP(n){ xp+=n; if(xp>=next){ xp-=next; level++; next=Math.floor(next*1.35); toast(`Level Up! Sekarang Lv ${level} ✨`); pixelBurst(); } renderXP(); }
// passive XP on scroll and interactions
let lastY=0; window.addEventListener('scroll',()=>{const dy=Math.abs(scrollY-lastY); if(dy>600){ grantXP(2); lastY=scrollY; }});
$$('.project').forEach(p=>p.addEventListener('click',()=>grantXP(5)));

/* ===== Toast & particles (smoother) ===== */
const toastEl=$('#toast'); let toastTimer=null;
function toast(msg){ clearTimeout(toastTimer); toastEl.textContent=msg; toastEl.classList.add('show'); toastTimer=setTimeout(()=>toastEl.classList.remove('show'),2700) }
function pixelBurst(){
  const c=document.createElement('canvas'); Object.assign(c.style,{position:'fixed',inset:0,pointerEvents:'none',zIndex:95}); c.width=innerWidth; c.height=innerHeight; document.body.appendChild(c);
  const ctx2=c.getContext('2d');
  const parts=Array.from({length:90},()=>({x:innerWidth/2,y:innerHeight-40, vx:(Math.random()-0.5)*5.2, vy:-Math.random()*6-3.6, life:64, color:`hsl(${Math.random()*60+90} 80% 60%)`}));
  function step(){
    ctx2.clearRect(0,0,c.width,c.height);
    parts.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; p.vy+=0.12; p.life--; ctx2.fillStyle=p.color; ctx2.fillRect(p.x, p.y, 4, 4); });
    if(parts.some(p=>p.life>0)) requestAnimationFrame(step); else c.remove();
  } step();
}

/* ===== Chat Commands (tanpa /help) ===== */
const cmd=$('#cmd'); const goMap={ '/about':'#tentang','/projects':'#proyek','/contact':'#kontak'};
cmd.addEventListener('keydown',e=>{
  if(e.key!=='Enter')return;
  const v=cmd.value.trim(); if(!v) return;
  if(goMap[v]){ smoothTo($(goMap[v])); grantXP(3); }
  else if(v.startsWith('/biome')){ const b=v.split(' ')[1]; if(biomeList.includes(b)){ pickBiome(b); toast('Biome set to '+b); grantXP(2);} else toast('Biome tidak dikenal'); }
  else if(v==='/torch'){ toggleTorch(); grantXP(1); }
  else if(v==='/music'){ toggleMusic($('#musicBtn')); }
  else if(v==='/creeper'){ creeperEasterEgg(); }
  else { toast('Perintah tidak dikenal'); }
  cmd.value='';
});

/* ===== Skin picker ===== */
$$('.skin').forEach(s=>s.addEventListener('click',()=>{
  const data=JSON.parse(s.dataset.skin);
  $$('#walker .skin-head').forEach(el=>el.setAttribute('fill',data.head));
  $$('#walker .skin-body').forEach(el=>el.setAttribute('fill',data.body));
  $$('#walker .skin-leg').forEach(el=>el.setAttribute('fill',data.leg));
  grantXP(1);
}));

/* ===== Creeper Easter Egg (glitch+shake) ===== */
function creeperEasterEgg(){
  toast('💥 Sssss... Creeper!');
  const c=document.createElement('div');
  c.style.cssText='position:fixed;inset:0;pointer-events:none;zIndex:120;mix-blend-mode:screen';
  const cvs=document.createElement('canvas'); cvs.width=innerWidth; cvs.height=innerHeight; c.appendChild(cvs);
  document.body.appendChild(c);
  const ctx3=cvs.getContext('2d');
  let t=0; const shake=()=>{ t++; ctx3.clearRect(0,0,cvs.width,cvs.height);
    for(let i=0;i<220;i++){ ctx3.fillStyle=`hsl(${90+Math.random()*30} 90% ${50+Math.random()*30}%)`; ctx3.fillRect(Math.random()*cvs.width, Math.random()*cvs.height, 6, 6); }
    document.body.style.transform=`translate(${(Math.random()-0.5)*6}px, ${(Math.random()-0.5)*6}px)`;
    document.body.style.filter=`contrast(1.02)`;
    if(t<15) requestAnimationFrame(shake); else { document.body.style.transform=''; document.body.style.filter=''; c.remove(); sfxRedstone(); }
  }; shake();
}

/* ===== Init biome on load ===== */
const initialBiome = randomBiome(); pickBiome(initialBiome);

/* ===== Accessibility: focus within cards adds lift shadow ===== */
$$('.card').forEach(c=>{
  c.addEventListener('focusin',()=>c.style.boxShadow='0 18px 46px rgba(0,0,0,.52)');
  c.addEventListener('focusout',()=>c.style.boxShadow='var(--shadow)');
});
</script>
</body>
</html>
